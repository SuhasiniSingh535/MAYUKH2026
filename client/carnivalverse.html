<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CarnivalVerse | Mayukh 2026</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&family=Bungee&display=swap" rel="stylesheet">
  <style>
    body { background-color: #0a000a; color: #ff00ff; font-family: 'Rajdhani', sans-serif; background-image: radial-gradient(circle at center, #1a001a 0%, #0a000a 100%); }
    .bungee { font-family: 'Bungee', cursive; } .orbitron { font-family: 'Orbitron', sans-serif; }
    .carnival-glow { text-shadow: 0 0 10px #ff00ff, 0 0 20px #00ffff; }
    .glass { background: rgba(20, 0, 20, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255, 0, 255, 0.15); box-shadow: 0 0 20px rgba(255, 0, 255, 0.15); }
    .hover-glow:hover { color: #ff00ff; text-shadow: 0 0 10px #ff00ff, 0 0 20px #00ffff; }
    .carnival-card { background: rgba(20, 0, 20, 0.8); border: 2px solid rgba(0, 255, 255, 0.2); border-radius: 20px; transition: all 0.4s; }
    .carnival-card:hover { border-color: #ff00ff; transform: translateY(-10px) rotate(1deg); box-shadow: 0 10px 30px rgba(255, 0, 255, 0.3); }
    .btn-carnival { background: linear-gradient(45deg, #ff00ff, #00ffff); color: white; text-transform: uppercase; font-weight: 900; letter-spacing: 2px; transition: all 0.3s ease; border-radius: 10px; }
    .btn-carnival:hover { box-shadow: 0 0 20px #ff00ff; transform: scale(1.05); }
    #carnival-particles { position: fixed; top: 0; left: 0; z-index: 0; pointer-events: none; }
    ::-webkit-scrollbar { width: 8px; } ::-webkit-scrollbar-track { background: #0a000a; } ::-webkit-scrollbar-thumb { background: linear-gradient(to bottom, #ff00ff, #00ffff); border-radius: 10px; }
  </style>
</head>
<body class="overflow-x-hidden">
  <canvas id="carnival-particles"></canvas>
  <a href="theme2.html#carnival-verse" class="fixed top-6 left-6 z-50 glass px-6 py-3 rounded-xl border border-pink-900/40 flex items-center gap-2 hover:border-pink-600 hover:text-pink-500 transition-all group">
      <i class="fa-solid fa-chevron-left text-sm transition-transform group-hover:-translate-x-1"></i>
      <span class="text-xs tracking-widest">THEME</span>
  </a>

  <main class="relative z-10 min-h-screen flex flex-col items-center pt-24 pb-20 px-4">
    <div class="text-center mb-16">
      <p class="text-xs orbitron tracking-[0.5em] mb-2 opacity-80 text-cyan-400 uppercase">Verse III // Interactive Imagination</p>
      <h1 class="bungee text-6xl md:text-8xl font-black carnival-glow mb-4 tracking-tighter">CARNIVAL<span class="text-cyan-400">VERSE</span></h1>
      <div class="h-1.5 w-72 bg-gradient-to-r from-pink-500 via-cyan-400 to-pink-500 mx-auto rounded-full"></div>
      <p class="mt-6 text-xl max-w-3xl text-pink-100/70 font-medium italic">"A colorful universe of gaming, design, and entertainment where imagination knows no rules."</p>
    </div>

    <div id="carnival-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10 max-w-7xl w-full px-6 md:px-20">
       <p class="col-span-full text-center text-pink-500 animate-pulse">Loading Carnival Events...</p>
    </div>
  </main>

  <script src="api-config.js"></script>
  <script>
    // --- PARTICLE EFFECT ---
    const canvas = document.getElementById('carnival-particles');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth; canvas.height = window.innerHeight;
    let particles = [];
    const colors = ['#ff00ff', '#00ffff', '#ffff00', '#ff0055'];
    class Particle {
      constructor() { this.init(); }
      init() { this.x = Math.random() * canvas.width; this.y = Math.random() * canvas.height; this.size = Math.random() * 4 + 1; this.speedY = Math.random() * 2 + 0.5; this.speedX = Math.random() * 1 - 0.5; this.color = colors[Math.floor(Math.random() * colors.length)]; this.opacity = Math.random(); }
      update() { this.y += this.speedY; this.x += this.speedX; if (this.y > canvas.height) this.init(); }
      draw() { ctx.fillStyle = this.color; ctx.globalAlpha = this.opacity; ctx.beginPath(); ctx.fillRect(this.x, this.y, this.size, this.size); }
    }
    function init() { for (let i = 0; i < 150; i++) particles.push(new Particle()); }
    function animate() { ctx.clearRect(0, 0, canvas.width, canvas.height); particles.forEach(p => { p.update(); p.draw(); }); requestAnimationFrame(animate); }
    init(); animate();
    window.addEventListener('resize', () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; });

    // --- DYNAMIC DATA LOGIC ---
    const CURRENT_VERSE = 'carnival-verse';

    function createCardHTML(event) {
        // Tag Logic
        let tag = 'EVENT';
        if(event.eventType.includes('tech-event')) tag = 'TECH';
        else if(event.eventType.includes('non-tech')) tag = 'NON-TECH';
        else if(event.eventType.includes('workshop')) tag = 'WORKSHOP';

        return `
          <div class="carnival-card p-5 flex flex-col h-full">
            <div class="w-full h-48 bg-pink-900/20 border-2 border-dashed border-pink-500/30 rounded-xl mb-6 overflow-hidden relative group">
              <div class="absolute inset-0 flex items-center justify-center opacity-20 group-hover:opacity-0 transition">
                ${event.logoLink ? `<img src="${event.logoLink}" class="w-20 h-20 object-contain">` : `<i class="fa-solid fa-gamepad text-7xl"></i>`}
              </div>
              <img src="${event.posterLink}" alt="${event.title}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
            </div>
            <div class="flex-grow">
              <div class="flex justify-between items-center mb-3">
                <h3 class="bungee text-xl text-pink-400 uppercase leading-tight">${event.title}</h3>
                <span class="text-[10px] orbitron bg-cyan-500/20 px-2 py-1 text-cyan-300 rounded border border-cyan-500/30">${tag}</span>
              </div>
              <p class="text-pink-100/60 text-sm leading-relaxed mb-4 line-clamp-3">
                ${event.description}
              </p>
              <div class="text-xs text-cyan-200 mb-4 font-mono">
                 <i class="fa-regular fa-calendar mr-1"></i> ${event.day} | ${event.time}
              </div>
            </div>
            <a href="${event.registrationLink}" target="_blank" class="btn-carnival w-full py-3 orbitron text-xs block text-center mt-auto">
              JOIN THE FUN
            </a>
          </div>
        `;
    }

    async function loadVerseData() {
        try {
            const res = await fetch(API_CONFIG.eventsUrl);
            const data = await res.json();
            const container = document.getElementById('carnival-container');
            
            if(!data.events) return;

            // 1. Filter by Verse
            let events = data.events.filter(e => e.category === CURRENT_VERSE);

            // 2. Sort: Tech Event -> Non-Tech Event -> Tech Workshop -> Non-Tech Workshop
            const order = { 'tech-event': 1, 'non-tech-event': 2, 'tech-workshop': 3, 'non-tech-workshop': 4, 'fun-event': 5 };
            events.sort((a, b) => (order[a.eventType] || 99) - (order[b.eventType] || 99));

            if(events.length > 0) {
                container.innerHTML = events.map(createCardHTML).join('');
            } else {
                container.innerHTML = `<p class="col-span-full text-center text-xl text-pink-500/50 bungee">No Events Scheduled Yet</p>`;
            }
        } catch(err) { console.error(err); }
    }
    loadVerseData();
  </script>
</body>
</html>