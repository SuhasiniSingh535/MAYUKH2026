<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
    <title>Team Mayukh | Multiverse 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background-color: #02040a;
            color: white;
            font-family: 'Rajdhani', sans-serif;
            overflow-x: hidden;
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        .orbitron { font-family: 'Orbitron', sans-serif; }
        
        main { padding-left: env(safe-area-inset-left); padding-right: env(safe-area-inset-right); }
        
        #bg-glow {
            position: fixed;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            z-index: -2;
            transition: background 1.5s cubic-bezier(0.4, 0, 0.2, 1);
            background: radial-gradient(circle at center, rgba(59, 196, 255, 0.1) 0%, #02040a 90%);
        }

        #star-canvas {
            position: fixed;
            top: 0; left: 0;
            z-index: -1;
            pointer-events: none;
        }

        .btn-back {
            position: fixed;
            top: max(1rem, calc(env(safe-area-inset-top) + 0.5rem));
            left: max(1rem, calc(env(safe-area-inset-left) + 0.5rem));
            z-index: 100;
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 0.75rem 1.25rem;
            border-radius: 50px;
            transition: all 0.4s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            color: white;
            text-decoration: none;
            font-size: 0.75rem;
            min-height: 44px;
            min-width: 44px;
            cursor: pointer;
            touch-action: manipulation;
        }
        
        @media (min-width: 768px) {
            .btn-back {
                top: 2rem;
                left: 2rem;
                padding: 0.8rem 1.6rem;
                font-size: 0.875rem;
            }
        }
        
        .btn-back:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: #3bc4ff;
            box-shadow: 0 0 20px rgba(59, 196, 255, 0.4);
        }

        .hero-section {
            min-height: 100vh;
            height: auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: max(1rem, env(safe-area-inset-top)) 0.5rem max(1rem, env(safe-area-inset-bottom));
        }
        
        @media (min-width: 480px) {
            .hero-section {
                padding: max(2rem, env(safe-area-inset-top)) 1rem max(2rem, env(safe-area-inset-bottom));
            }
        }

        .team-title {
            font-size: clamp(1.5rem, 8vw, 4rem);
            font-weight: 900;
            letter-spacing: 0.05em;
            margin-bottom: 1.5rem;
            color: white;
            -webkit-text-stroke: 1px var(--team-color);
            paint-order: stroke fill;
            filter: drop-shadow(0 0 12px var(--shadow-color));
            text-transform: uppercase;
            max-width: 95vw;
            overflow-wrap: break-word;
            word-break: break-word;
        }
        
        @media (min-width: 480px) {
            .team-title {
                font-size: clamp(1.75rem, 8vw, 3rem);
                letter-spacing: 0.06em;
                margin-bottom: 2rem;
                -webkit-text-stroke: 1.2px var(--team-color);
            }
        }

        @media (min-width: 640px) {
            .team-title {
                font-size: clamp(2rem, 8vw, 3.5rem);
                margin-bottom: 2.5rem;
            }
        }
        
        @media (min-width: 768px) {
            .team-title {
                font-size: clamp(2.5rem, 8vw, 4rem);
                margin-bottom: 3rem;
                letter-spacing: 0.08em;
                -webkit-text-stroke: 1.5px var(--team-color);
            }
        }

        @media (min-width: 1024px) {
            .team-title {
                margin-bottom: 3.5rem;
                letter-spacing: 0.1em;
            }
        }

        .hero-title {
            font-size: clamp(1.5rem, 8vw, 7rem);
            line-height: 1.1;
            max-width: 100%;
            word-break: break-word;
        }
        
        @media (max-width: 480px) {
            .hero-title {
                font-size: clamp(1.3rem, 9vw, 2.5rem);
                letter-spacing: 0.1em;
            }
        }

        .photo-box {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.08);
            width: 100%;
            max-width: 400px;
            aspect-ratio: 9/10;
            border-radius: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.6s cubic-bezier(0.165, 0.84, 0.44, 1);
            position: relative;
            overflow: hidden;
            flex-direction: column;
            margin: 0 auto;
            background-size: cover;
            background-position: center;
        }

        .photo-box::before {
            content: '';
            position: absolute;
            inset: 0;
            background: inherit;
            background-size: cover;
            background-position: center;
            filter: blur(25px) brightness(0.3);
            z-index: 1;
        }
        
        @media (min-width: 768px) {
            .photo-box {
                border-radius: 1.75rem;
                width: 90%;
            }
        }
        
        @media (min-width: 1024px) {
            .photo-box {
                width: 85%;
            }
        }

        .photo-box img {
            position: relative;
            z-index: 2;
            width: 100%;
            height: 100%;
            object-fit: contain;
            object-position: center;
            border-radius: inherit;
            transition: all 0.6s ease;
            display: block;
            background: transparent;
        }

        .skeleton {
            background: linear-gradient(90deg, rgba(59, 196, 255, 0.1) 25%, rgba(59, 196, 255, 0.2) 50%, rgba(59, 196, 255, 0.1) 75%);
            background-size: 200% 100%;
            animation: skeleton-loading 1.5s infinite;
        }

        @keyframes skeleton-loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        @media (hover: hover) and (pointer: fine) {
            .photo-container:hover .photo-box {
                border-color: var(--team-color);
                box-shadow: 0 20px 50px var(--shadow-color);
                transform: translateY(-12px) scale(1.02);
            }

            .photo-container:hover .photo-box img {
                transform: scale(1.05);
                filter: brightness(1.1);
            }
        }

        .description-text {
            font-family: 'Orbitron', sans-serif;
            font-weight: 900;
            font-size: clamp(1rem, 3vw, 1.6rem);
            letter-spacing: 0.3em;
            color: white;
            -webkit-text-stroke: 1px var(--team-color);
            margin-top: 1rem;
            display: block;
            transition: all 0.5s ease;
            text-transform: uppercase;
        }
        
        @media (min-width: 768px) {
            .description-text {
                margin-top: 1.5rem;
            }
        }

        .members-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            width: 100%;
        }

        @media (min-width: 480px) {
            .members-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 1.75rem;
            }
        }

        @media (min-width: 640px) {
            .members-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 2rem;
            }
        }

        @media (min-width: 1024px) {
            .members-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 2.5rem;
            }
        }

        @media (min-width: 1280px) {
            .members-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 2.5rem;
            }
        }

        .team-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            padding: 3rem 1rem;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .team-section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        #scroll-to-top {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 2.5rem;
            height: 2.5rem;
            background: rgba(59, 196, 255, 0.1);
            border: 1px solid rgba(59, 196, 255, 0.3);
            border-radius: 50%;
            color: #3bc4ff;
            cursor: pointer;
            opacity: 0;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            z-index: 40;
        }

        #scroll-to-top.show {
            opacity: 1;
        }

        #scroll-to-top:hover {
            background: rgba(59, 196, 255, 0.2);
            transform: translateY(-2px);
        }

        #typewriter {
            min-height: 1.5em;
            overflow: hidden;
            word-break: break-word;
        }
    </style>
</head>
<body>
    <div id="bg-glow"></div>
    <canvas id="star-canvas"></canvas>

    <a href="index.html" class="btn-back">
        <i class="fa-solid fa-arrow-left"></i>
        <span class="hidden sm:inline">BACK</span>
    </a>

    <main>
        <section class="hero-section">
            <div>
                <h1 class="hero-title orbitron font-black mb-4" id="typewriter"></h1>
                <p class="text-sm md:text-lg text-gray-400 max-w-2xl mx-auto">Meet the brilliant minds shaping the Multiverse</p>
            </div>
        </section>

        <div id="teams-container" class="w-full"></div>
    </main>

    <button id="scroll-to-top" title="Scroll"><i class="fa-solid fa-chevron-up"></i></button>

    <script src="api-config.js"></script>
    <script>
        const API_URL = API_CONFIG.teamsUrl;
        const CACHE_KEY = 'mayukh_teams_cache';
        const CACHE_TIME_KEY = 'mayukh_teams_time';
        const CACHE_DURATION = 300000;
        const container = document.getElementById('teams-container');

        const teamColors = {
            'Technical': '#3bc4ff',
            'PR': '#ff6b6b',
            'Drama': '#ffd700',
            'Cultural': '#ff69b4',
            'Sponsorship': '#00ff00',
            'Decor': '#ff8800',
            'Catering': '#ff6347',
            'Workshop': '#00bfff',
            'Discipline': '#c71585',
            'Coverage': '#32cd32',
            'Digital': '#1e90ff',
            'Finance': '#ffa500'
        };

        function sanitizeHTML(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function getFromCache() {
            try {
                const cached = localStorage.getItem(CACHE_KEY);
                const cacheTime = localStorage.getItem(CACHE_TIME_KEY);
                if (cached && cacheTime && (Date.now() - parseInt(cacheTime) < CACHE_DURATION)) {
                    return JSON.parse(cached);
                }
            } catch (e) {
                console.error(e);
            }
            return null;
        }

        function saveToCache(data) {
            try {
                localStorage.setItem(CACHE_KEY, JSON.stringify(data));
                localStorage.setItem(CACHE_TIME_KEY, Date.now().toString());
            } catch (e) {
                console.error(e);
            }
        }

        async function fetchAndRenderTeams() {
            try {
                const cachedData = getFromCache();
                if (cachedData) {
                    renderTeams(cachedData);
                } else {
                    showSkeletonLoaders();
                }

                const res = await fetch(API_URL);
                if (!res.ok) throw new Error(`HTTP ${res.status}`);
                const members = await res.json();

                saveToCache(members);
                renderTeams(members);
            } catch (err) {
                console.error(err);
                
                const cachedData = getFromCache();
                if (!cachedData) {
                    container.innerHTML = `<p class="text-center text-red-400 font-mono text-sm md:text-base px-4 py-10">Offline Mode: Backend unavailable</p>`;
                }
            }
        }

        function showSkeletonLoaders() {
            const order = ['Technical', 'PR', 'Drama', 'Cultural'];
            container.innerHTML = order.map(teamName => `
                <section class="team-section visible" style="--team-color: #3bc4ff;">
                    <h2 class="orbitron team-title text-center">${teamName}</h2>
                    <div class="w-full px-4 max-w-6xl">
                        <div class="members-grid">
                            <div class="flex flex-col items-center">
                                <div class="photo-box skeleton"></div>
                                <div class="mt-4 w-32 h-6 skeleton rounded"></div>
                            </div>
                            <div class="flex flex-col items-center">
                                <div class="photo-box skeleton"></div>
                                <div class="mt-4 w-32 h-6 skeleton rounded"></div>
                            </div>
                        </div>
                    </div>
                </section>
            `).join('');
        }

        function renderTeams(members) {
            const groupedTeams = members.reduce((acc, member) => {
                const tName = member.teamName;
                if (!acc[tName]) {
                    acc[tName] = { 
                        name: tName, 
                        color: teamColors[tName] || '#3bc4ff', 
                        members: []
                    };
                }
                acc[tName].members.push(member);
                return acc;
            }, {});

            container.innerHTML = '';
            
            const order = ['Technical', 'PR', 'Drama', 'Cultural', 'Sponsorship', 'Decor', 'Catering', 'Workshop', 'Discipline', 'Coverage','Digital','Finance'];

            order.forEach(teamName => {
                const team = groupedTeams[teamName];
                if (!team) return;

                const section = document.createElement('section');
                section.className = 'team-section';
                section.style.setProperty('--team-color', team.color);
                section.style.setProperty('--shadow-color', team.color + '44');
                
                const renderMembers = (list) => {
                    if(!list || list.length === 0) {
                        return `
                        <div class="flex flex-col items-center w-full">
                            <div class="photo-box">
                                <i class="fa-solid fa-users text-4xl md:text-6xl opacity-20 relative z-10" style="color:${team.color}"></i>
                                <span class="orbitron text-xs mt-2 opacity-50 tracking-widest relative z-10">COMING SOON</span>
                            </div>
                            <p class="description-text">Team Loading...</p>
                        </div>
                        `;
                    }

                    if(list.length > 1) {
                        const membersHtml = list.map(m => `
                            <div class="flex flex-col items-center">
                                <div class="photo-box" style="background-image: url('${sanitizeHTML(m.imageUrl)}')">
                                    <img src="${sanitizeHTML(m.imageUrl)}" alt="${sanitizeHTML(m.name)}" loading="lazy" onerror="this.src='https://via.placeholder.com/400x500?text=Team'" />
                                </div>
                                <p class="description-text">${sanitizeHTML(m.name)}</p>
                            </div>
                        `).join('');
                        return `<div class="members-grid">${membersHtml}</div>`;
                    } else {
                        const m = list[0];
                        return `
                        <div class="flex flex-col items-center w-full">
                            <div class="photo-box" style="background-image: url('${sanitizeHTML(m.imageUrl)}')">
                                <img src="${sanitizeHTML(m.imageUrl)}" alt="${sanitizeHTML(m.name)}" loading="lazy" onerror="this.src='https://via.placeholder.com/400x500?text=Team'" />
                            </div>
                            <p class="description-text">${sanitizeHTML(m.name)}</p>
                        </div>
                        `;
                    }
                };

                section.innerHTML = `
                  <div class="flex flex-col items-center w-full">
                    <h2 class="orbitron team-title text-center">${sanitizeHTML(team.name)}</h2>
                    
                    <div class="w-full px-4 max-w-6xl"> 
                      <div class="photo-container text-center group w-full h-full">
                        ${renderMembers(team.members)}
                      </div>
                    </div>
                  </div>
                `;
                
                container.appendChild(section);
                
                setTimeout(() => section.classList.add('visible'), 50);
                
                if(typeof observer !== 'undefined') observer.observe(section);
            });
        }

        const text = "ARCHITECTS OF THE MULTIVERSE";
        let i = 0;
        function typeWriter() {
            if (i < text.length) {
                document.getElementById("typewriter").innerHTML += text.charAt(i);
                i++;
                setTimeout(typeWriter, 100);
            }
        }
        
        const canvas = document.getElementById('star-canvas');
        const ctx = canvas.getContext('2d');
        let stars = [];

        function initStars() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            stars = [];
            const starCount = window.innerWidth < 768 ? 150 : 300;
            for(let i=0; i<starCount; i++) {
                stars.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    size: Math.random() * 2.5,
                    speed: Math.random() * 0.5 + 0.1,
                    opacity: Math.random(),
                    twinkle: Math.random() * 0.02
                });
            }
        }

        function animateStars() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            stars.forEach(s => {
                ctx.fillStyle = `rgba(255, 255, 255, ${s.opacity})`;
                ctx.beginPath();
                ctx.arc(s.x, s.y, s.size, 0, Math.PI*2);
                ctx.fill();
                s.y -= s.speed;
                s.opacity += s.twinkle;
                if(s.y < 0) s.y = canvas.height;
                if(s.opacity > 1 || s.opacity < 0.2) s.twinkle *= -1;
            });
            requestAnimationFrame(animateStars);
        }

        const bgGlow = document.getElementById('bg-glow');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    const color = entry.target.style.getPropertyValue('--team-color');
                    bgGlow.style.background = `radial-gradient(circle at center, ${color}15 0%, #02040a 90%)`;
                }
            });
        }, { threshold: 0.25 });

        const scrollToTopBtn = document.getElementById('scroll-to-top');
        let lastScrollTop = 0;
        let isScrollingDown = false;

        function updateButtonFunction() {
            const isAtBottom = window.pageYOffset + window.innerHeight >= document.documentElement.scrollHeight - 100;
            if (isAtBottom) isScrollingDown = false;

            const icon = scrollToTopBtn.querySelector('i');
            if (isScrollingDown) icon.className = 'fa-solid fa-chevron-down';
            else icon.className = 'fa-solid fa-chevron-up';

            scrollToTopBtn.onclick = () => {
                if (isScrollingDown) window.scrollBy({ top: window.innerHeight, behavior: 'smooth' });
                else window.scrollTo({ top: 0, behavior: 'smooth' });
            };
        }

        window.addEventListener('scroll', () => {
            const currentScroll = window.pageYOffset;
            if (currentScroll > lastScrollTop) isScrollingDown = true;
            else isScrollingDown = false;
            lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;

            if (window.pageYOffset > 300) scrollToTopBtn.classList.add('show');
            else scrollToTopBtn.classList.remove('show');
            updateButtonFunction();
        });

        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                initStars();
            }, 250);
        });

        window.addEventListener('load', () => {
            typeWriter();
            initStars();
            animateStars();
            updateButtonFunction();
            fetchAndRenderTeams();
        });
    </script>
</body>
</html>
